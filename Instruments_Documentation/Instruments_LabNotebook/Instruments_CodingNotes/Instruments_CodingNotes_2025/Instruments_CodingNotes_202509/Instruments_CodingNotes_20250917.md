# evaluate_offsets.py
- Left off with all possible offsets added to concatenated 2025 data
- Now, will actually calibrate the data using all possible offsets and sensitivities (where appropriate)
	- For fixed offset, apply sensitivity of the same calibration
	- For other offsets, check all sensitivities to see
- Added sensitivity columns to make it easier to calculate without having to go back into the calibration data
- First, uses fixed calibration offsets to calibrate data
- Then, for each calibration date, uses the UZA and Temperature correlation offsets to calibrate
- Now, will plot
	- A lot of data, so going to take this slowly and start by comparing the different fixed offsets
	- Even with this, plotting is taking a very long time - perhaps split by week?
		- Did that, and wrote script to plot both with matplotlib and hvplot - comment out the one that isn't desired
		- Also added skipping some instruments to make it faster to look at only one at a time
	- Fixed offsets
		- 2BTech_205_A
			- 20240119 calibration is a bit higher, but still only by ~0.8 ppb - within uncertainty
				- Other cals are closer together - almost on top of each other
					- Noteable that first cal was done with Farmer group cal source, all the other ones with Willis group cal source
				- Will be using 2025 cals anyway for this particular data
			- All basically the same within uncertainty, I believe differences are more likely due to difference in offset rather than sensitivity - more pronounced here than it will be using other methods of offset correction
		- 2BTech_205_B
			- Varies by ~0.8 ppb, again mostly consistent
		- Picarro_G2307
			- Varies by ~0.5 ppb at lower concentrations, when high by up to ~5 ppb
				- Again, may be more due to different offsets, although sensitivity was also quite different between the two cals
					- 2026-06-25 cal is more consistent with what would be expected, so probably going to chose that one
		- ThermoScientific_42i-TL
			- February 2024 cals are WAY different than July/December, unsurprising given first was SDC cal and second was with low N2O flow
			- Reliable cals are within ~1 ppb
				- I suspect other offset corrections will bring them closer together also
	- From examining fixed offset, determined that most cals are generally consistent with one another
		- 2BTech_205_A: Use 20250115
		- 2BTech_205_B: Use 20250115
		- Picarro_G2307: Use 20250625
		- ThermoScientific_42i-TL: Use 20241216
			- Need cal data for the cals Emma ran - later problem
	- Now, using the calibration date I have settled on looking at the different offsets
		- Visually
			- 2BTech_205_A
				- UZA and temperature correlation offset are very close together and generally are higher than the fixed offset
				- Fixed offset does become more reasonable moving into late March (as expected)
			- Picarro_G2307
				- No temperature correlation one, but fixed offset seems to be close in general
					- Expected, UZA measurements don't drift all that much
					- Within 1 ppb it seems
			- ThermoScientific_42i-TL
				- Temperature correlation offset is pretty incredible for this instrument, almost exactly follows UZA offset
		- Now actually calculating the differences
			- Using UZA measurements as the "correct" ones, going to calculate absolute difference relative to Fixed and temperature based offsets after sensitivity factors applied
			- 2BTech_205_A
				- Temperature correlation not nearly as good as it is for Thermo sadly
					- Still improved relative to fixed offset which overestimates by ~2 ppb
			- Picarro_G2307
				- Not so worried about this one given zero ~ always running when it's on
				- Fixed offset overestimates by <1.2 ppb, reasonably close
			- ThermoScientific_42i-TL
				- UZA and Temp difference is pretty consistently centered ~0 for both NO and NO2
				- Fixed offset overestimates NO and underestimates NO2 relative to UZA offset
				- Through ~Jan 27, the difference between UZA and Temp offset is more pronounced (pre zeroing implementation), so temperature based offset likely better during this time
		- Statistics on differences
			- Switching plots to do the full timeseries for visualization - good plots to show Megan!
				- Doing some renaming to make the figures more clear
			- Calculated median and lower and upper quantiles of differences
				- 2BTech_205_A
					- Fixed: 1.5985 (0.8942 - 2.0031)
						- min to max (0.1377 - 5.3477)
					- Temperature: -0.1094 (-0.3548 - 0.1841)
						- min to max (-2.0813 - 3.7675)
				- Picarro_G2307
					- Fixed: 0.4503 (0.3418 - 0.6773)
						- min to max (0.0834 - 1.2294)
				- ThermoScientific_42i-TL
					- NO
						- Fixed: 0.6040 (0.5649 - 0.6777)
							- min to max (0.3215 - 0.7833)
						- Temperature: -0.0043 (-0.0381 - 0.0322)
							- min to max (-0.5463 - 0.2401)
					- NO2
						- Fixed: -0.8549 (-0.9691 - -0.7650)
							- min to max (-1.6178 - -0.2691)
						- Temperature: 0.0017 (-0.0600 - 0.0680)
							- min to max (-1.2081 - 0.5919)
			- Decided to plot with the UZA data because I want to see if that gives any insight as to the cause of the "large" deviations