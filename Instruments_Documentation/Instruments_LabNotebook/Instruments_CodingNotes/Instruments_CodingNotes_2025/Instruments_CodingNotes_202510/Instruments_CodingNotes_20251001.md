# align_timestamps.py
- After some thought, I realized that I don't want to use the valve states that were exported to define UZA start/stop - I want to use the Picarro data
	- That way when I adjust the Picarro timestamps, I end up with adjusted valve state times which will work better
	- Easy change to make
- Uncommented the code to adjust Picarro time drift, seeing what that does
	- Added code to plot outliers
	- After correcting time drift, needed to switch join_asof strategy to forward - seems to move the time to be more real
	- Correcting the time drift may be the only thing I need to do for the Picarro instrument
- After checking that the starts and stops were being appropriately identified, reverted the code back to work with joining and plotting differences
	- Does not appear that I corrected the time drift - maybe need to do the reverse of what I did?
		- Yes, that fixed it!
	- Also realized why it should always be a forward join - if Picarro is ahead, then the valve open/closed is inevitably in front of the first/last UZA measurement
- As a side note, it seems that for some weeks the time drift correction overcorrected - need to figure out how to handle that later
- Going to apply a constant offset of 288 seconds to Picarro and remove the time drift to see what that does
	- WAYYYYY too much
- Constant offset of 100s looks reasonable, so expect something within 60 seconds of that
- August 12, 2024 07:53:22 - with a -65s offset, synced with 2BTech_205_A
- Thinking I would actually prefer to have it aligned at the start - will be easier to correct drift after
	- June 10, 2024 08:44:08 aligned with a -56s offset
		- Looks like it's aligned at August 4 also, but not always aligned between?
		- Very clearly drifts weeks of June 24, July 1
			- No or only slight drift other weeks?
- Consider how to correct when no timestamps aligned - choose true timestamp for several false timestamps and interpolate?
	- Likely yes
- Plan is now to identify offsets at several different timestamps and interpolate between those
	- Through June 17 ~13:00, -56 s offset good
	- June 30 23:45, should be -67s offset
		- keep through July 11
	- -56 s offset good starting July 12
	- -60s offset July 20
	- -50s offset July 22
	- -56 July 30
	- -60 through Aug 12
	- -56 on Aug 12
- Settled on timestamp corrections
- Now looking into NOx
	- There is for sure a drift on the NOx - looks relatively steady slope though
		- Actually when I look at it relative to O3, doesn't look like there is a drift
			- Maybe there is a small one
	- For this instrument, going to set two real timestamps - one at the start, one at the end, and interpolate between those
		- ~~Actually I'm just not going to change the NOx timestamp at all~~
- I may revert Picarro timestamp correction to just be a fixed offset - seems to me like it's good enough and then I can leave it
	- Actually, with the amount of work I did I want to say it's fine how it is
- Added code to calculate the duration that the valves are open for each open/closed timestamp
- For Thermo, drift seems to be ~40 us/s
	- When I try to implement that it DOES NOT work
- Going back to my original plan - use the timestamps that I decided on with Picarro, don't change Thermo at all